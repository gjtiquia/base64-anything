<!doctype html>
<html lang="en" class="no-transition">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="light dark">
    <!-- Critical CSS to prevent flash -->
    <style>
      html.no-transition * {
        transition: none !important;
      }
      
      html {
        background-color: #ffffff;
      }

      html[data-theme="dark"] {
        background-color: #1a1a1a;
      }
      
      :root {
        --color-background: #ffffff;
        --color-text: #333333;
        --color-surface: #f5f5f5;
      }
      
      [data-theme="dark"] {
        --color-background: #1a1a1a;
        --color-text: #f5f5f5;
        --color-surface: #333333;
      }
      
      body {
        background-color: var(--color-background);
        color: var(--color-text);
        margin: 0;
      }
    </style>
    <!-- Preload the CSS file -->
    <link rel="preload" href="./src/style.css" as="style">
    <link rel="stylesheet" href="./src/style.css">
    <script>
      // Apply theme from localStorage immediately to prevent flash
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      
      // Apply dark theme if explicitly saved as dark or not saved but user prefers dark
      if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
        document.documentElement.setAttribute('data-theme', 'dark');
        document.body.setAttribute('data-theme', 'dark');
      }
      
      // Remove the no-transition class after a short delay
      window.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
          document.documentElement.classList.remove('no-transition');
        }, 100);
      });
    </script>
    <title>base64 anything</title>
  </head>
  <body>
    <div id="app">
      <header>
        <h1>base64 anything</h1>
        <button id="theme-toggle" aria-label="Toggle dark mode">üåô</button>
      </header>

      <main>
        <section id="encode-section">
          <h2>encode file to base64</h2>
          <div class="dropzone" id="file-dropzone">
            <p>drag and drop a file here, or</p>
            <input type="file" id="file-input" />
            <label for="file-input">choose a file</label>
          </div>
          <div class="result-container">
            <textarea id="encode-result" placeholder="base64 output will appear here..." readonly></textarea>
            <button id="copy-encode" class="copy-btn">copy</button>
            <button id="download-encode" class="download-btn">download as .txt</button>
          </div>
        </section>

        <section id="decode-section">
          <h2>decode base64 to file</h2>
          <div class="input-container">
            <textarea id="decode-input" placeholder="paste base64 string here..."></textarea>
            <button id="decode-btn">decode</button>
          </div>
          <div class="result-container">
            <div id="decode-result">
              <p>decoded file will appear here...</p>
            </div>
            <div class="file-info" id="file-info"></div>
            <div class="file-type-container" id="file-type-container" style="display: none;">
              <label for="file-extension">file extension:</label>
              <input type="text" id="file-extension" placeholder="e.g. jpg, pdf, txt" />
              <p class="hint">the file type couldn't be determined. please specify a file extension for the decoded file.</p>
            </div>
            <button id="download-decode" class="download-btn">download file</button>
          </div>
        </section>
      </main>

      <footer>
        <p>made with ‚ù§Ô∏è - <a href="https://github.com/gjtiquia/base64-anything" target="_blank">github</a></p>
      </footer>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
